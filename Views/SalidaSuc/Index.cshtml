@model WebApplication2.Models.Tb_SalidaSuc

@{

    List<SelectListItem> items = (List<SelectListItem>)ViewBag.items;
    ViewBag.title = "Entrada";

}


<div class="col-sm-6 mt-3">
    <div class="card shadow-lg rounded">
        <div class="card-header bg-dark text-white">
            <h5>Saldo actual</h5>
        </div>
        <div class="card-body">
            @Html.Action("tsalida")
        </div>
        <div class="card-footer">
            <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#Entrada">
                Ingresar
            </button>
        </div>
    </div>

</div>

<div class="modal fade" id="Entrada" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Ingresa Saldo De salida</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <form>
                        <div class="form-row">


                            <div class="col-sm-6 mb-2">
                                <label>Saldo salida</label>
                                <div class="col-md-10">
                                    @Html.EditorFor(model => model.Dbl_SaldoSalida, new { htmlAttributes = new { @class = "form-control" } })
                                    @Html.ValidationMessageFor(model => model.Dbl_SaldoSalida, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            <div class="col-sm-6 mb-3">
                                <label>Moneda</label>

                                @Html.DropDownList("Datos", items, "Selecciona la divisa", new { @type = "number", @class = "form-control", @id = "padre" })

                                <div class="" style="display: none">
                                    @Html.EditorFor(model => model.Int_IdMoneda, new { htmlAttributes = new { @class = "form-control", @id = "idmonedaEnt", @readonly = true } })
                                    @Html.ValidationMessageFor(model => model.Int_IdMoneda, "", new { @class = "text-danger" })
                                </div>
                            </div>


                            <div>
                                <label>Sucursal</label>

                                <div class="col-md-10">
                                    <input class="form-control" disabled id="NomSucursal" value=@Session["sucursaledelusuario"] />

                                    <div style="display: none">
                                        <input id="IdSucursal" value="@Session["idSucursal"]" />
                                        @Html.EditorFor(model => model.int_IdSucursal, new { htmlAttributes = new { @class = "form-control", @id = "intsucursal", @readonly = true } })
                                        @Html.ValidationMessageFor(model => model.int_IdSucursal, "", new { @class = "text-danger" })
                                    </div>

                                    <div style="display: none">
                                        @Html.EditorFor(Model => Model.Bol_Activo, new { AllowHtmlAttribute = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(Model => Model.Bol_Activo, "", new { @class = "text-danger" })
                                    </div>

                                    <div style="display: none">
                                        <input id="iduser" value="@User.Identity.Name" />
                                        @Html.EditorFor(model => model.Int_Idusuario, new { htmlAttributes = new { @class = "form-control", @id = "userpost", @readonly = true } })

                                        <input id="turno" value="@Session["turno"]" />
                                        @Html.EditorFor(model => model.Int_IdTurno, new { htmlAttributes = new { @class = "form-control", @id = "turnopost", @readonly = true } })


                                    </div>

                                </div>
                            </div>

                            <div class="col-sm-6 mb-3" style="display:none">
                                <label>Fecha Entrada</label>
                                <div class="col-md-10">
                                    @Html.TextBoxFor(model => model.Fec_Fin, new { @Value = @DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss") })
                                    @Html.ValidationMessageFor(model => model.Fec_Fin, "", new { @class = "text-danger" })
                                </div>
                            </div>



                            <div class="col-sm-12 mt-4">
                                <button type="submit" class="btn btn-success">Guardar </button>
                            </div>

                        </div>

                    </form>

                    <script>
                        function completado() {

                            Swal.fire({
                                position: 'top-end',
                                icon: 'success',
                                title: 'Actulizado',
                                showConfirmButton: false,
                                timer: 3000
                            })

                            location.reload();
                        }
                    </script>

                }
            </div>

        </div>
    </div>
</div>


<script>

    var monedaEntrada = document.getElementById("padre");
    monedaEntrada.addEventListener("change", refresh);

    refresh();

    function refresh() {

        var mon = document.getElementById("padre").value;
        document.getElementById("idmonedaEnt").value = mon;




        var idsucursal = document.getElementById("IdSucursal").value;
        document.getElementById("intsucursal").value = idsucursal;

        var idu = document.getElementById("iduser").value;
        document.getElementById("userpost").value = idu;

        var turno = document.getElementById("turno").value;
        document.getElementById("turnopost").value = turno;


        document.getElementById("Bol_Activo").value = "true";

    }

</script>
